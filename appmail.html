<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Gmail Mobile - Syst&#232;me Complet</title>
    <link href="https://fonts.googleapis.com/css2?family=Sora:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #f4efe9;
            --paper: #fffdf8;
            --accent: #0f6d3a;
            --accent-2: #f2c14e;
            --ink: #1b1b1b;
            --muted: #6b6b6b;
            --border: rgba(0,0,0,0.08);
            --shadow: 0 12px 30px rgba(16, 24, 40, 0.12);
            --soft-shadow: 0 6px 16px rgba(16, 24, 40, 0.1);
        }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body, html { margin: 0; padding: 0; height: 100%; font-family: 'Sora', sans-serif; background: var(--bg); overflow: hidden; color: var(--ink); }
        body::before {
            content: "";
            position: fixed;
            inset: 0;
            background: linear-gradient(135deg, #f4efe9 0%, #e7f2ff 45%, #fef7e7 100%);
            opacity: 0.9;
            z-index: -1;
        }

        /* --- HEADER --- */
        header {
            display: flex; align-items: center; padding: 10px 16px; height: 60px;
            background: var(--paper); margin: 10px; border-radius: 28px; box-shadow: var(--soft-shadow);
        }
        .burger { font-size: 24px; padding-right: 15px; cursor: pointer; }
        .search-in { flex: 1; border: none; background: transparent; font-size: 16px; outline: none; color: var(--ink); }

        /* --- SIDEBAR --- */
        #sidebar {
            position: fixed; top: 0; left: -280px; width: 280px; height: 100%;
            background: var(--paper); z-index: 1000; transition: 0.3s; box-shadow: 2px 0 18px rgba(0,0,0,0.18);
            overflow-y: auto;
        }
        #sidebar.open { left: 0; }
        .sidebar-title { padding: 20px; color: #c23b31; font-size: 20px; font-weight: 600; border-bottom: 1px solid var(--border); }
        .nav-label { padding: 15px 20px 5px; font-size: 11px; color: var(--muted); font-weight: 600; text-transform: uppercase; letter-spacing: 0.06em; }
        .nav-item { padding: 12px 20px; font-size: 14px; display: flex; align-items: center; gap: 12px; border-radius: 0 25px 25px 0; margin-right: 10px; cursor: pointer; }
        .nav-item.active { background: #e7f1ff; color: #1f4a83; font-weight: 600; }
        .icon { width: 20px; text-align: center; display: inline-flex; align-items: center; justify-content: center; }

        /* --- EMAIL LIST --- */
        #email-list { height: calc(100% - 72px); overflow-y: auto; }
        .list-header { padding: 12px 16px; font-size: 11px; color: var(--muted); background: rgba(255,255,255,0.8); border-bottom: 1px solid var(--border); letter-spacing: 0.08em; }
        .email-row { display: flex; padding: 16px; border-bottom: 1px solid var(--border); align-items: center; transition: background 0.2s ease; }
        .email-row.unread { font-weight: 600; }
        .email-row:active { background: rgba(15, 109, 58, 0.06); }
        .avatar { width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 15px; color: white; flex-shrink: 0; font-weight: normal; }
        .info { flex: 1; min-width: 0; }
        .top-row { display: flex; justify-content: space-between; margin-bottom: 4px; }
        .subj { font-size: 14px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .email-date { font-size: 12px; color: var(--muted); font-weight: 400; }

        /* --- FAB --- */
        .fab { position: fixed; bottom: 25px; right: 25px; background: linear-gradient(135deg, #f2c14e, #f08a5d); width: 56px; height: 56px; border-radius: 16px; display: flex; align-items: center; justify-content: center; font-size: 24px; box-shadow: var(--shadow); z-index: 500; color: #1b1b1b; }

        /* --- DETAIL VIEW --- */
        #detail-view { position: fixed; top: 0; left: 100%; width: 100%; height: 100%; background: var(--paper); z-index: 2000; transition: 0.3s; overflow-y: auto; }
        #detail-view.open { left: 0; }
        .detail-bar { display: flex; align-items: center; padding: 12px; gap: 20px; border-bottom: 1px solid var(--border); background: var(--paper); position: sticky; top: 0; }
        .detail-icon { font-size: 20px; cursor: pointer; padding: 5px; }
        .detail-title { font-weight: 500; margin: 0; }
        .detail-meta { color: var(--muted); font-size: 12px; line-height: 1.4; }
        .detail-body { line-height: 1.6; white-space: pre-wrap; color: #2b2b2b; }
        .reply-btn { flex: 1; padding: 10px 14px; border: 1px solid var(--border); background: white; border-radius: 20px; display: inline-flex; align-items: center; justify-content: center; gap: 8px; font-family: inherit; }

        /* --- BOTTOM SHEET (MOVE) --- */
        #move-sheet { position: fixed; bottom: -100%; left: 0; width: 100%; background: white; z-index: 4000; transition: 0.3s; border-radius: 20px 20px 0 0; box-shadow: 0 -5px 15px rgba(0,0,0,0.2); padding: 20px 0; }
        #move-sheet.open { bottom: 0; }
        .move-option { padding: 15px 25px; font-size: 16px; border-bottom: 1px solid #f9f9f9; display: flex; align-items: center; gap: 10px; }

        /* --- REDACTION --- */
        #compose-view { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--paper); z-index: 3000; display: none; flex-direction: column; }
        .comp-header { display: flex; align-items: center; padding: 15px; justify-content: space-between; border-bottom: 1px solid var(--border); }
        .comp-field { display: flex; align-items: center; padding: 12px 16px; border-bottom: 1px solid var(--border); }
        .field-label { width: 40px; color: var(--muted); font-size: 14px; }
        .field-input { flex: 1; border: none; outline: none; font-size: 16px; font-family: inherit; }
        #extra-fields { display: none; flex-direction: column; }
        #extra-fields.show { display: flex; }
        .comp-body { flex: 1; padding: 16px; border: none; outline: none; font-size: 16px; resize: none; font-family: inherit; }

        .overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: none; z-index: 999; }
    </style>

  <link rel="stylesheet" href="mobile.css">
</head>
<body>

    <div id="overlay" class="overlay" onclick="closeAllMenus()"></div>

    <!-- SIDEBAR -->
    <aside id="sidebar">
        <div class="sidebar-title">Gmail</div>
        <div class="nav-label">Syst&#232;me</div>
        <div class="nav-item active" id="nav-inbox" onclick="setFolder('inbox')"><span class="icon">&#128229;</span><span>Bo&#238;te de r&#233;ception</span></div>
        <div class="nav-item" id="nav-sent" onclick="setFolder('sent')"><span class="icon">&#128228;</span><span>Envoy&#233;s</span></div>
        <div class="nav-item" id="nav-trash" onclick="setFolder('trash')"><span class="icon">&#128465;</span><span>Corbeille</span></div>

        <div class="nav-label">Mes Dossiers</div>
        <div id="custom-folders-list"></div>
        <div style="padding: 10px 20px;">
            <input type="text" id="new-folder-input" placeholder="+ Cr&#233;er (Appuyez Entr&#233;e)" onkeypress="createNewFolder(event)" style="width:100%; padding:8px; border:1px solid #ddd; border-radius:4px; outline:none;">
        </div>
    </aside>

    <header>
        <div class="burger" onclick="toggleSidebar()">&#9776;</div>
        <input type="text" class="search-in" placeholder="Rechercher..." onkeyup="render()">
        <div class="user-avatar" style="width:30px; height:30px; background:var(--accent); color:white; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:12px;">U</div>
    </header>

    <div id="email-list"></div>

    <div class="fab" onclick="openCompose()">&#9998;</div>

    <!-- DETAIL VIEW -->
    <div id="detail-view">
        <div class="detail-bar">
            <div onclick="closeDetail()" style="font-size:24px">&#8592;</div>
            <div style="flex:1"></div>
            <div class="detail-icon" onclick="openMoveSheet()">&#128194;</div>
            <div class="detail-icon" onclick="deleteEmail()">&#128465;</div>
        </div>
        <div id="detail-content" style="padding:20px;"></div>
    </div>

    <!-- MOVE SHEET -->
    <div id="move-sheet">
        <div style="text-align:center; padding-bottom:15px; color:gray; font-size:14px">D&#233;placer vers...</div>
        <div id="move-options-list"></div>
        <div class="move-option" style="text-align:center; color:red; border-top:1px solid #eee" onclick="closeMoveSheet()">Annuler</div>
    </div>

    <!-- REDACTION -->
    <div id="compose-view">
        <div class="comp-header">
            <div onclick="closeCompose()" style="font-size:20px">&#10005;</div>
            <div style="font-weight:500;">R&#233;diger</div>
            <div onclick="sendEmail()" style="color:var(--accent); font-weight:bold;">ENVOYER</div>
        </div>
        <div class="comp-field">
            <span class="field-label">&Agrave;</span>
            <input type="text" id="c-to" class="field-input">
            <div onclick="toggleExtra()" style="color:var(--muted); font-size:12px; cursor:pointer">&#9662;</div>
        </div>
        <div id="extra-fields">
            <div class="comp-field"><span class="field-label">Cc</span><input type="text" id="c-cc" class="field-input"></div>
            <div class="comp-field"><span class="field-label">Cci</span><input type="text" id="c-bcc" class="field-input"></div>
        </div>
        <div class="comp-field"><input type="text" id="c-sub" class="field-input" placeholder="Objet"></div>
        <textarea id="c-msg" class="comp-body" placeholder="&#201;crire un e-mail"></textarea>
    </div>

<script>
    // --- DONNEES ---
    const ICONS = {
        inbox: "\u{1F4E5}",
        sent: "\u{1F4E4}",
        trash: "\u{1F5D1}",
        folder: "\u{1F4C1}"
    };
    let emails = [
        { id: 1, folder: 'inbox', from: 'Netflix', sub: 'Nouveaut\u00e9s de la semaine', body: 'D\u00e9couvrez les derniers films ajout\u00e9s.', date: '10:00', unread: true },
        { id: 2, folder: 'inbox', from: 'Amazon', sub: 'Confirmation de commande', body: 'Votre colis n\u00b01234 est en route.', date: 'Hier', unread: false },
        { id: 3, folder: 'inbox', from: 'Air France', sub: 'Enregistrement ouvert', body: 'Votre enregistrement est disponible pour le vol AF178.', date: '08:41', unread: true },
        { id: 4, folder: 'inbox', from: 'LinkedIn', sub: 'Vous avez 3 nouvelles vues', body: 'Votre profil a \u00e9t\u00e9 consult\u00e9 3 fois cette semaine.', date: '08:05', unread: false },
        { id: 5, folder: 'inbox', from: 'Canal+', sub: 'Votre facture est pr\u00eate', body: 'La facture de juin est disponible dans votre espace.', date: 'Hier', unread: false },
        { id: 6, folder: 'inbox', from: 'La Poste', sub: 'Colis en livraison', body: 'Votre colis sera livr\u00e9 aujourd\u2019hui entre 13h et 15h.', date: 'Hier', unread: true },
        { id: 7, folder: 'sent', from: 'Moi', to: 'Nadia', sub: 'Planning de la semaine', body: 'Salut, je te propose un point mardi matin.', date: 'Lun', unread: false },
        { id: 8, folder: 'sent', from: 'Moi', to: 'Paul', sub: 'Devis projet', body: 'Voici le devis mis \u00e0 jour.', date: 'Lun', unread: false },
        { id: 9, folder: 'trash', from: 'PromoShop', sub: 'Offres \u00e0 -70%', body: 'Derniers jours pour profiter des remises.', date: 'Dim', unread: false },
        { id: 10, folder: 'inbox', from: 'TGV INOUI', sub: 'Votre billet \u00e9lectronique', body: 'Billet joint pour votre trajet Paris-Lyon.', date: 'Dim', unread: false },
        { id: 11, folder: 'inbox', from: 'Doctolib', sub: 'Rappel de rendez-vous', body: 'Rappel: rendez-vous le 12/07 \u00e0 09:30.', date: 'Dim', unread: true },
        { id: 12, folder: 'inbox', from: 'GitHub', sub: 'Nouvelle pull request', body: 'Une PR est ouverte sur votre d\u00e9p\u00f4t appmail.', date: 'Sam', unread: false },
        { id: 13, folder: 'inbox', from: 'Spotify', sub: 'Votre Mix de la semaine', body: 'Nouvelles recommandations pr\u00eates \u00e0 \u00e9couter.', date: 'Sam', unread: false },
        { id: 14, folder: 'inbox', from: 'Leroy Merlin', sub: 'Votre commande est pr\u00eate', body: 'Retrait possible d\u00e8s demain en magasin.', date: 'Sam', unread: false },
        { id: 15, folder: 'inbox', from: 'URSSAF', sub: 'D\u00e9claration \u00e0 valider', body: 'Merci de valider votre d\u00e9claration mensuelle.', date: 'Ven', unread: true }
    ];
    let myFolders = ['Travail', 'Perso'];
    let currentFolder = 'inbox';
    let openedId = null;

    // --- RENDU LISTE ---
    function render() {
        const list = document.getElementById('email-list');
        const query = document.querySelector('.search-in').value.toLowerCase();
        list.innerHTML = '';
        const header = document.createElement('div');
        header.className = 'list-header';
        header.textContent = currentFolder.toUpperCase();
        list.appendChild(header);

        emails
            .filter(m => m.folder === currentFolder && (m.from.toLowerCase().includes(query) || m.sub.toLowerCase().includes(query)))
            .reverse()
            .forEach(m => {
                const row = document.createElement('div');
                row.className = `email-row ${m.unread ? 'unread' : ''}`;
                row.addEventListener('click', () => openDetail(m.id));

                const avatar = document.createElement('div');
                avatar.className = 'avatar';
                avatar.style.background = stringToColor(m.from);
                avatar.textContent = m.from ? m.from[0] : '?';

                const info = document.createElement('div');
                info.className = 'info';

                const top = document.createElement('div');
                top.className = 'top-row';

                const from = document.createElement('span');
                from.textContent = m.from;

                const date = document.createElement('span');
                date.className = 'email-date';
                date.textContent = m.date;

                top.append(from, date);

                const subj = document.createElement('div');
                subj.className = 'subj';
                subj.textContent = m.sub;

                info.append(top, subj);
                row.append(avatar, info);
                list.appendChild(row);
            });
        renderSidebarFolders();
    }

    function renderSidebarFolders() {
        const container = document.getElementById('custom-folders-list');
        container.innerHTML = '';
        myFolders.forEach(f => {
            const div = document.createElement('div');
            div.className = `nav-item ${currentFolder === f ? 'active' : ''}`;
            const icon = document.createElement('span');
            icon.className = 'icon';
            icon.textContent = ICONS.folder;
            const label = document.createElement('span');
            label.textContent = f;
            div.append(icon, label);
            div.addEventListener('click', () => setFolder(f));
            container.appendChild(div);
        });
    }

    // --- GESTION DOSSIERS ---
    function createNewFolder(e) {
        if (e.key === 'Enter' && e.target.value.trim()) {
            myFolders.push(e.target.value.trim());
            e.target.value = '';
            renderSidebarFolders();
        }
    }

    function setFolder(f) {
        currentFolder = f;
        document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
        if (document.getElementById('nav-' + f)) document.getElementById('nav-' + f).classList.add('active');
        closeAllMenus();
        render();
    }

    // --- RESET & REDACTION ---
    function resetCompose() {
        document.getElementById('c-to').value = '';
        document.getElementById('c-cc').value = '';
        document.getElementById('c-bcc').value = '';
        document.getElementById('c-sub').value = '';
        document.getElementById('c-msg').value = '';
        document.getElementById('extra-fields').classList.remove('show');
    }

    function openCompose(to = '', sub = '', msg = '') {
        resetCompose();
        document.getElementById('c-to').value = to;
        document.getElementById('c-sub').value = sub;
        document.getElementById('c-msg').value = msg;
        document.getElementById('compose-view').style.display = 'flex';
    }

    function sendEmail() {
        const to = document.getElementById('c-to').value;
        if (!to) return alert("Veuillez indiquer un destinataire.");

        emails.push({
            id: Date.now(), folder: 'sent', from: 'Moi', to: to,
            cc: document.getElementById('c-cc').value,
            bcc: document.getElementById('c-bcc').value,
            sub: document.getElementById('c-sub').value,
            body: document.getElementById('c-msg').value,
            date: '\u00c0 l\'instant', unread: false
        });

        resetCompose();
        closeCompose();
        alert("Envoy\u00e9 !");
        render();
    }

    // --- NAVIGATION ---
    function toggleSidebar() {
        document.getElementById('sidebar').classList.toggle('open');
        document.getElementById('overlay').style.display = document.getElementById('sidebar').classList.contains('open') ? 'block' : 'none';
    }
    function closeCompose() { document.getElementById('compose-view').style.display = 'none'; }
    function toggleExtra() { document.getElementById('extra-fields').classList.toggle('show'); }
    function closeAllMenus() {
        document.getElementById('sidebar').classList.remove('open');
        document.getElementById('move-sheet').classList.remove('open');
        document.getElementById('overlay').style.display = 'none';
    }

    function openDetail(id) {
        openedId = id;
        const m = emails.find(e => e.id == id);
        m.unread = false;
        document.getElementById('detail-view').classList.add('open');

        const detail = document.getElementById('detail-content');
        detail.innerHTML = '';

        const title = document.createElement('h2');
        title.className = 'detail-title';
        title.textContent = m.sub;

        const metaRow = document.createElement('div');
        metaRow.style.display = 'flex';
        metaRow.style.alignItems = 'center';
        metaRow.style.gap = '12px';
        metaRow.style.margin = '20px 0';

        const avatar = document.createElement('div');
        avatar.className = 'avatar';
        avatar.style.background = stringToColor(m.from);
        avatar.textContent = m.from ? m.from[0] : '?';

        const metaText = document.createElement('div');
        metaText.style.flex = '1';

        const from = document.createElement('b');
        from.textContent = m.from;

        const metaLine = document.createElement('div');
        metaLine.className = 'detail-meta';
        metaLine.textContent = `\u00c0: ${m.to || 'moi'}`;

        metaText.append(from, metaLine);

        if (m.cc) {
            const ccLine = document.createElement('div');
            ccLine.className = 'detail-meta';
            ccLine.textContent = `Cc: ${m.cc}`;
            metaText.appendChild(ccLine);
        }

        const date = document.createElement('div');
        date.className = 'detail-meta';
        date.textContent = m.date;

        metaRow.append(avatar, metaText, date);

        const body = document.createElement('div');
        body.className = 'detail-body';
        body.textContent = m.body;

        const replyRow = document.createElement('div');
        replyRow.style.marginTop = '30px';
        replyRow.style.display = 'flex';
        replyRow.style.gap = '10px';

        const replyBtn = document.createElement('button');
        replyBtn.className = 'reply-btn';
        replyBtn.addEventListener('click', prepareReply);
        replyBtn.textContent = '\u21a9 R\u00e9pondre';

        replyRow.appendChild(replyBtn);

        detail.append(title, metaRow, body, replyRow);
        render();
    }

    function prepareReply() {
        const m = emails.find(e => e.id == openedId);
        openCompose(m.from, 'Re: ' + m.sub, "\n\n--- Message d'origine ---\n" + m.body);
    }

    function closeDetail() { document.getElementById('detail-view').classList.remove('open'); }

    // --- DEPLACER ---
    function openMoveSheet() {
        document.getElementById('move-sheet').classList.add('open');
        document.getElementById('overlay').style.display = 'block';
        const list = document.getElementById('move-options-list');
        list.innerHTML = '';
        ['inbox', 'sent', 'trash', ...myFolders].forEach(f => {
            if (f !== currentFolder) {
                const div = document.createElement('div');
                div.className = 'move-option';
                const icon = document.createElement('span');
                icon.className = 'icon';
                icon.textContent = ICONS[f] || ICONS.folder;
                const label = document.createElement('span');
                label.textContent = f;
                div.append(icon, label);
                div.addEventListener('click', () => { moveEmailTo(f); closeMoveSheet(); });
                list.appendChild(div);
            }
        });
    }

    function closeMoveSheet() { document.getElementById('move-sheet').classList.remove('open'); if (!document.getElementById('sidebar').classList.contains('open')) document.getElementById('overlay').style.display = 'none'; }

    function moveEmailTo(folder) {
        const m = emails.find(e => e.id == openedId);
        if (m) {
            m.folder = folder;
            alert("Email d\u00e9plac\u00e9");
            closeDetail();
            render();
        }
    }

    function deleteEmail() { moveEmailTo('trash'); }

    // --- UTILITAIRES ---
    function stringToColor(str) {
        let hash = 0;
        for (let i = 0; i < str.length; i++) hash = str.charCodeAt(i) + ((hash << 5) - hash);
        const hue = ((hash % 360) + 360) % 360;
        return `hsl(${hue}, 60%, 40%)`;
    }

    render();
</script>
</body>
</html>
